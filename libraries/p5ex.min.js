/**
* An extension of p5.js.
* Including module: no-more-for-loops (Copyright 2018 FAL, licensed under MIT).
* GitHub repository: {@link https://github.com/fal-works/p5ex}
* @module p5ex
* @copyright 2018 FAL
* @author FAL <falworks.contact@gmail.com>
* @license MIT
* @version 0.5.3
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.p5ex={})}(this,function(t){"use strict";class e{}class s extends e{get width(){return this.rightPositionX-this.leftPositionX}get height(){return this.bottomPositionY-this.topPositionY}get area(){return this.width*this.height}constructor(t,e,s,i,n=0){super(),this.leftPositionX=t-n,this.topPositionY=e-n,this.rightPositionX=s+n,this.bottomPositionY=i+n}contains(t,e=0){return t.x>=this.leftPositionX-e&&t.x<=this.rightPositionX+e&&t.y>=this.topPositionY-e&&t.y<=this.bottomPositionY+e}constrain(t,e=0){t.x<this.leftPositionX-e?t.x=this.leftPositionX-e:t.x>this.rightPositionX+e&&(t.x=this.rightPositionX+e),t.y<this.topPositionY-e?t.y=this.topPositionY-e:t.y>this.bottomPositionY+e&&(t.y=this.bottomPositionY+e)}}class i{constructor(t,e,i,n){this.p=t,this.canvasElement=t.createCanvas(e.scaledWidth,e.scaledHeight,n),this.canvasElement&&"parent"in this.canvasElement&&this.canvasElement.parent(i),this.region=new s(0,0,0,0),this.nonScaledShortSideLength=e.nonScaledShortSideLength,this.updateSize()}get scaleFactor(){return this._scaleFactor}get nonScaledWidth(){return this._nonScaledWidth}get nonScaledHeight(){return this._nonScaledHeight}get aspectRatio(){return this._aspectRatio}resize(t){this.p.resizeCanvas(t.scaledWidth,t.scaledHeight),this.nonScaledShortSideLength=t.nonScaledShortSideLength,this.updateSize()}updateSize(){const t=this.p;this._scaleFactor=Math.min(t.width,t.height)/this.nonScaledShortSideLength,this._inversedScaleFactor=1/this._scaleFactor,this._nonScaledWidth=t.width/this._scaleFactor,this._nonScaledHeight=t.height/this._scaleFactor,this._aspectRatio=t.width/t.height,this.region.rightPositionX=this._nonScaledWidth,this.region.bottomPositionY=this._nonScaledHeight}scale(){this.p.scale(this._scaleFactor)}cancelScale(){this.p.scale(this._inversedScaleFactor)}getNonScaledValueOf(t){return t/this._scaleFactor}}i.DUMMY_PARAMETERS={scaledWidth:100,scaledHeight:100,nonScaledShortSideLength:100};const n={SQUARE640x640:"SQUARE640x640",RECT640x480:"RECT640x480",FULL:"FULL",CUSTOM:"CUSTOM"};class r{constructor(t,e){this.p=t,this.p5Color=e}stroke(){this.p.currentRenderer.stroke(this.p5Color)}fill(){this.p.currentRenderer.fill(this.p5Color)}}class a{constructor(t){this.p=t}stroke(){this.p.currentRenderer.noStroke()}fill(){this.p.currentRenderer.noFill()}}class o{stroke(){}fill(){}}class h{constructor(t,e,s=256){this.p=t;const i=[];for(let n=0;n<s;n+=1)i.push(t.color(t.red(e),t.green(e),t.blue(e),t.alpha(e)*n/(s-1)));this.colorArray=i,this.maxIndex=s-1}stroke(t){this.p.currentRenderer.stroke(this.getColor(t))}fill(t){this.p.currentRenderer.fill(this.getColor(t))}getColor(t){return this.colorArray[t?Math.floor(this.p.map(t,0,255,0,this.maxIndex)):this.maxIndex]}}function l(t,e,s,i){return t&&void 0!==e?null===e?new a(t):s?new h(t,e,i):new r(t,e):new o}class c{constructor(t,e,s,i,n){this.strokeColor=l(t,e,i,n),this.fillColor=l(t,s,i,n)}applyColor(t){this.strokeColor.stroke(t),this.fillColor.fill(t)}}c.UNDEFINED=new c(void 0,void 0,void 0);const u=()=>{},d=(Math.PI,new p5(t=>{t.setup=(()=>{t.noCanvas()})}));function p(t,e){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)+Math.pow(e.z-t.z,2)}function g(t,e,s){const i=t.length,n=t[0].length,r=s||new Array(i);for(let a=0;a<i;a+=1){r[a]=0;for(let s=0;s<n;s+=1)r[a]+=t[a][s]*e[s]}return r}const f=2*Math.PI;function y(t,e){let s=(t-e)%f;return s<-Math.PI?s+=f:s>Math.PI&&(s-=f),s}function m(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}d.createVector(),d.createVector();function R(t,e,s){return t+s*(e-t)}function C(t){return Math.floor(Math.random()*t)}function x(t){return t[C(t.length)]}class S{constructor(t=0){this.value=t}valueOf(){return this.value}}S.NULL=new S;function w(t){return t}function v(t){return 1-Math.pow(t-1,2)}function A(t){return Math.pow(t-1,3)+1}function P(t){return 1-Math.pow(t-1,4)}const M=1.70158;const F=t=>t>6/29?t*t*t:6/29*3*(6/29)*(t-16/116);const b=[[3.2406255,-1.537208,-.4986286],[-.9689307,1.8757561,.0415175],[.0557101,-.2040211,1.0569959]];class L{constructor(t,e){this.name=t,this.tristimulusValues=e}}const _={D50:new L("D50",[.9642,1,.8251]),D55:new L("D55",[.9568,1,.9214]),D65:new L("D65",[.95047,1,1.08883]),E:new L("E",[1,1,1])};function V(t){return t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055}let k=_.D50;const D=[0,0,0],E=[0,0,0],W=[0,0,0],O=[0,0,0];function T(t,e,s,i){return t[0]=e,t[1]=s,t[2]=i,t}function I(t){return 255*V(Math.min(Math.max(t,0),1))}function N(t,e,s,i){const n=function(t,e,s){const i=(t[0]+16)/116,n=i+t[1]/500,r=i-t[2]/200;return s?(s[0]=e.tristimulusValues[0]*F(n),s[1]=e.tristimulusValues[1]*F(i),s[2]=e.tristimulusValues[2]*F(r),s):[e.tristimulusValues[0]*F(n),e.tristimulusValues[1]*F(i),e.tristimulusValues[2]*F(r)]}(T(D,t,e,s),k,E),r=g(b,n,W),a=T(O,I(r[0]),I(r[1]),I(r[2]));return i?[a[0],a[1],a[2],i]:[a[0],a[1],a[2]]}class z{constructor(t){this.p=t}}function B(t,e,s){let i=0;for(;i<s;)e(t[i],i,t),i+=1}function U(t,e,s){for(;s--;)e(t[s],s,t)}function Y(t,e,s){for(let i=0,n=s-1;i<n;i+=1)for(let r=i+1;r<s;r+=1)e(t[i],t[r])}function X(t,e,s,i,n){for(let r=0;r<i;r+=1)for(let i=0;i<n;i+=1)s(t[r],e[i])}class Q{constructor(t=256){this.array=new Array(t),this.length=0}get(t){return this.array[t]}getLast(){return this.array[this.length-1]}push(t){return this.array[this.length]=t,this.length+=1,this.length}pushRawArray(t,e=t.length){for(let s=0;s<e;s+=1)this.array[this.length+s]=t[s];return this.length+=e,this.length}pushAll(t){return this.pushRawArray(t.array,t.length)}pop(){return this.length-=1,this.array[this.length]}clear(){this.length=0}loop(t){B(this.array,t,this.length)}loopBackwards(t){U(this.array,t,this.length)}roundRobin(t){Y(this.array,t,this.length)}nestedLoopJoin(t,e){X(this.array,t.array,e,this.length,t.length)}}class H extends Q{constructor(t,e,s){if(super(t*e),this.xCount=t,this.yCount=e,s)for(let i=0,n=t*e;i<n;i+=1)this.push(s)}get2D(t,e){return this.array[t+this.xCount*e]}set2D(t,e,s){this.array[t+this.xCount*e]=s}}class G{getNeighborCell(t,e){return this}setNeighborCell(t,e,s){}}const j=new G;class q extends Q{static drawFunction(t){t.draw()}draw(){this.loop(q.drawFunction)}}class J extends Q{static stepFunction(t){t.step()}step(){this.loop(J.stepFunction)}}class K extends Q{}K.prototype.step=J.prototype.step,K.prototype.draw=q.prototype.draw;class Z extends Q{constructor(t){super(t),this.recentRemovedElements=new Q(t)}clean(){this.recentRemovedElements.clear();let t=0;for(let e=0;e<this.length;e+=1)this.array[e].clean(),this.array[e].isToBeRemoved?this.recentRemovedElements.push(this.array[e]):(this.array[t]=this.array[e],t+=1);this.length=t}}class $ extends Z{}$.prototype.draw=K.prototype.draw,$.prototype.step=K.prototype.step;class tt{constructor(t,e=1){this.p=t,this.internalValue=e,this.internalReciprocalValue=1/e}get value(){return this.internalValue}set value(t){if(0===t)return this.internalValue=1e-4,void(this.internalReciprocalValue=1e4);this.internalValue=t,this.internalReciprocalValue=1/t}get reciprocalValue(){return this.internalReciprocalValue}applyScale(){this.p.currentRenderer.scale(this.internalValue)}cancel(){this.p.currentRenderer.scale(this.internalReciprocalValue)}}class et{constructor(t,e,s){this.p=t,this.set(e,s)}set(t,e){this.element=t,this.position=e.positionRef||this.p.createVector(),this.offsetPosition=e.offsetPositionRef||this.p.createVector(),this.rotation=e.rotationAngleRef||S.NULL,this.scaleFactor=e.scaleFactorRef||new tt(this.p),this.shapeColor=e.shapeColorRef||c.UNDEFINED,this.alphaChannel=e.alphaChannelRef||S.NULL,this.strokeWeight=e.strokeWeightRef||S.NULL,this.textSize=e.textSizeRef||S.NULL,this.procedureList=this.createProcedureList(e),this.procedureListLength=this.procedureList.length}draw(){for(let t=0,e=this.procedureListLength;t<e;t+=1)this.procedureList[t](this)}drawElement(t){t.element.draw()}createProcedureList(t){const e=[];return t.shapeColorRef&&(t.alphaChannelRef?e.push(this.alphaColor):e.push(this.color)),t.textSizeRef&&e.push(this.applyTextSize),t.strokeWeightRef&&e.push(this.applyStrokeWeight),t.positionRef?t.offsetPositionRef?e.push(this.translateWithOffset):e.push(this.translate):t.offsetPositionRef&&e.push(this.translateOnlyOffset),t.scaleFactorRef&&e.push(this.scale),t.rotationAngleRef&&e.push(this.rotate),e.push(this.drawElement),t.rotationAngleRef&&e.push(this.cancelRotate),t.scaleFactorRef&&e.push(this.cancelScale),t.positionRef?t.offsetPositionRef?e.push(this.cancelTranslateWithOffset):e.push(this.cancelTranslate):t.offsetPositionRef&&e.push(this.cancelTranslateOnlyOffset),e}translate(t){t.p.currentRenderer.translate(t.position.x,t.position.y)}cancelTranslate(t){t.p.currentRenderer.translate(-t.position.x,-t.position.y)}translateOnlyOffset(t){t.p.currentRenderer.translate(t.offsetPosition.x,t.offsetPosition.y)}cancelTranslateOnlyOffset(t){t.p.currentRenderer.translate(-t.offsetPosition.x,-t.offsetPosition.y)}translateWithOffset(t){t.p.currentRenderer.translate(t.position.x+t.offsetPosition.x,t.position.y+t.offsetPosition.y)}cancelTranslateWithOffset(t){t.p.currentRenderer.translate(-(t.position.x+t.offsetPosition.x),-(t.position.y+t.offsetPosition.y))}rotate(t){t.p.currentRenderer.rotate(t.rotation.value)}cancelRotate(t){t.p.currentRenderer.rotate(-t.rotation.value)}scale(t){1!==t.scaleFactor.value&&t.scaleFactor.applyScale()}cancelScale(t){1!==t.scaleFactor.value&&t.scaleFactor.cancel()}color(t){t.shapeColor.applyColor()}alphaColor(t){t.shapeColor.applyColor(t.alphaChannel.value)}applyStrokeWeight(t){t.p.currentRenderer.strokeWeight(t.strokeWeight.value)}applyTextSize(t){t.p.currentRenderer.textSize(t.textSize.value)}}class st{constructor(t){this.drawShape=t}}const it=Math.sqrt(3)/2,nt={CIRCLE:new st((t,e)=>{t.ellipse(0,0,e,e)}),SQUARE:new st((t,e)=>{t.rect(0,0,e,e)}),REGULAR_TRIANGLE:new st((t,e)=>{const s=.5*e;t.triangle(s,0,-.5*s,-it*s,-.5*s,+it*s)}),REGULAR_TRIANGLE_UPWARD:new st((t,e)=>{const s=.5*e;t.triangle(0,s,-it*s,-.5*s,+it*s,-.5*s)})};function rt(t){t.startAngle.value>t.endAngle.value&&(t.endAngle.value+=t.p.TWO_PI)}function at(t){t.startAngle.value<t.endAngle.value&&(t.endAngle.value-=t.p.TWO_PI)}function ot(t,e,s,i,n){t.currentRenderer.arc(e.x,e.y,s,s,i,n)}function ht(t,e,s,i,n){t.currentRenderer.arc(e.x,e.y,s,s,n,i)}const lt=d.createVector(),ct=d.createVector();class ut{constructor(t,e,s){this.p=t,this.filePath=s||null,this.textFontArgument=e}loadFile(){this.filePath&&(this.textFontArgument=this.p.loadFont(this.filePath))}applyFont(){this.p.currentRenderer.textFont(this.textFontArgument)}}class dt{static get NULL(){return pt}constructor(t=0,e=0){this.angleReference=new S(t),this.angleVelocityReference=new S(e)}get angle(){return this.angleReference.value}set angle(t){this.angleReference.value=t}get angleVelocity(){return this.angleVelocityReference.value}set angleVelocity(t){this.angleVelocityReference.value=t}step(){this.angle+=this.angleVelocity}}const pt=new class extends dt{get angle(){return 0}set angle(t){}get angleVelocity(){return 0}set angleVelocity(t){}step(){}};class gt{constructor(){this.position=new p5.Vector,this.velocity=new p5.Vector}step(){this.position.add(this.velocity)}getSpeed(){return this.velocity.mag()}getDirection(){return this.velocity.heading()}addSpeed(t){this.velocity.setMag(Math.max(0,this.velocity.mag()+t))}}const ft=d.createVector();class yt{constructor(){this.count=0}resetCount(t=0){return this.count=t,this}step(){this.count+=1}mod(t){return this.count%t}}class mt extends yt{get isOn(){return this._isOn}constructor(t,e=u){super(),this._isOn=!0,this.completeBehavior=e,this.durationFrameCount=t}on(t){return this._isOn=!0,t&&(this.durationFrameCount=t),this}off(){return this._isOn=!1,this}step(){this._isOn&&(this.count+=1,this.count>this.durationFrameCount&&this.completeCycle())}}const Rt=new Map;t.p5exClass=class extends p5{setCurrentRenderer(t){this.currentRenderer=t}get nonScaledWidth(){return this.scalableCanvas.nonScaledWidth}get nonScaledHeight(){return this.scalableCanvas.nonScaledHeight}get idealFrameRate(){return this._idealFrameRate}get unitAngleSpeed(){return this._unitAngleSpeed}get unitSpeed(){return this._unitSpeed}get unitAccelerationMagnitude(){return this._unitAccelerationMagnitude}constructor(t,e,s){super(t,"string"==typeof e?document.getElementById(e)||void 0:e,s),this.node=e&&"boolean"!=typeof e?"string"==typeof e?document.getElementById(e)||document.body:e:document.body,this.currentRenderer=this,this.maxCanvasRegion={width:0,height:0,getShortSideLength(){return Math.min(this.width,this.height)}},this.updateMaxCanvasRegion(),this.setFrameRate()}setFrameRate(t=60){return this.frameRate(t),t&&(this._idealFrameRate=t,this._unitAngleSpeed=2*Math.PI/this._idealFrameRate,this._unitSpeed=1/this._idealFrameRate,this._unitAccelerationMagnitude=this._unitSpeed/this._idealFrameRate),this}updateMaxCanvasRegion(){if(this.maxCanvasRegion.width=this.windowWidth,this.maxCanvasRegion.height=this.windowHeight,this.node===document.body)return;const t=this.node.getBoundingClientRect();this.maxCanvasRegion.width=t.width,this.maxCanvasRegion.height=t.height}createScalableCanvas(t,e,s){this.scalableCanvasType=t,this.scalableCanvas=new i(this,this.createScalableCanvasParameter(t,e),this.node,s)}resizeScalableCanvas(t,e){this.scalableCanvas.resize(this.createScalableCanvasParameter(t||this.scalableCanvasType,e))}createScalableCanvasParameter(t,e){this.updateMaxCanvasRegion();const s=this.maxCanvasRegion.getShortSideLength();switch(t){case n.SQUARE640x640:return{scaledWidth:s,scaledHeight:s,nonScaledShortSideLength:640};case n.RECT640x480:return{scaledWidth:s,scaledHeight:.75*s,nonScaledShortSideLength:480};case n.FULL:return{scaledWidth:this.maxCanvasRegion.width,scaledHeight:this.maxCanvasRegion.height,nonScaledShortSideLength:640};default:return e||i.DUMMY_PARAMETERS}}},t.loopArray=function(t,e){B(t,e,t.length)},t.loopArrayBackwards=function(t,e){U(t,e,t.length)},t.roundRobin=function(t,e){Y(t,e,t.length)},t.nestedLoopJoin=function(t,e,s){X(t,e,s,t.length,e.length)},t.LoopableArray=Q,t.EMPTY_FUNCTION=u,t.distSq=p,t.multiplyMatrixAndArray=g,t.angleDifference=y,t.getDirectionAngle=m,t.lerp=R,t.randomBetween=function(t,e){return t+Math.random()*(e-t)},t.randomInt=C,t.randomIntBetween=function(t,e){return t+C(e-t)},t.getRandom=x,t.popRandom=function(t){return t.splice(C(t.length),1)[0]},t.randomSign=function(t){return Math.random()<.5?t:-t},t.NumberContainer=S,t.WeightedRandomSelector=class{constructor(){this.candidateList=[],this.candidateCount=0,this.totalProbabiligyWeight=0}push(t,e){return this.candidateList.push({element:t,threshold:this.totalProbabiligyWeight+e}),this.candidateCount+=1,this.totalProbabiligyWeight+=e,this}clear(){return this.candidateList.length=0,this.candidateCount=0,this.totalProbabiligyWeight=0,this}get(){const t=Math.random()*this.totalProbabiligyWeight;for(let e=0;e<this.candidateCount;e+=1)if(t<this.candidateList[e].threshold)return this.candidateList[e].element;return this.candidateList[this.candidateCount-1].element}},t.easeLinear=w,t.easeOutQuad=v,t.easeOutCubic=A,t.easeOutQuart=P,t.easeOutBack=function(t){const e=t-1;return(M+1)*Math.pow(e,3)+M*Math.pow(e,2)+1},t.getEasingFunction=function(t){switch(Math.floor(t)){default:case 1:return w;case 2:return v;case 3:return A;case 4:return P}},t.dummyP5=d,t.Region=e,t.RectangleRegion=s,t.ScalableCanvas=i,t.ScalableCanvasTypes=n,t.ScreenEffect=z,t.ScreenShake=class extends z{constructor(t,e=.95){super(t),this.dampingRatio=e,this.amplitude=0,this.offsetX=0,this.offsetY=0}apply(){0!==this.amplitude&&(this.offsetX=Math.random()*this.amplitude,this.offsetY=Math.random()*this.amplitude,this.p.currentRenderer.translate(this.offsetX,this.offsetY),this.amplitude=this.amplitude*this.dampingRatio,this.amplitude<1&&(this.amplitude=0))}set(t){this.amplitude=Math.max(this.amplitude,t)}reset(){this.amplitude=0}cancel(){this.p.currentRenderer.translate(-this.offsetX,-this.offsetY)}},t.ScreenFlash=class extends z{constructor(t,e=t.color(255)){super(t),this.alphaValue=0,this.valueChange=0,this.flashColor=new c(t,null,e,!0)}apply(){0!==this.alphaValue&&(this.flashColor.applyColor(this.alphaValue),this.p.currentRenderer.rect(0,0,this.p.scalableCanvas.nonScaledWidth,this.p.scalableCanvas.nonScaledHeight),this.alphaValue-=this.valueChange,this.alphaValue<1&&(this.alphaValue=0))}set(t,e){this.alphaValue=t,this.valueChange=t/(e*this.p.idealFrameRate)}reset(){this.alphaValue=0}},t.AlphaBackground=class{constructor(t,e,s=1,i,n){this.p=t,this.backgroundColor=e,this.drawIntervalFrameCount=s,this.blendModeString=i,this.defaultBlendModeString=n}draw(){this.p.frameCount%this.drawIntervalFrameCount==0&&(this.blendModeString&&this.p.blendMode(this.blendModeString),this.p.noStroke(),this.p.fill(this.backgroundColor),this.p.rect(0,0,this.p.width,this.p.height),this.defaultBlendModeString&&this.p.blendMode(this.defaultBlendModeString))}},t.mouseIsInCanvas=function(t){return!(t.mouseX<0||t.mouseX>t.width||t.mouseY<0||t.mouseY>t.height)},t.TwoDimensionalArray=H,t.NaiveEdge=class{constructor(t,e){this.nodeA=t,this.nodeB=e}isIncidentTo(t){return t===this.nodeA||t===this.nodeB}getAdjacentNode(t){return t===this.nodeB?this.nodeA:this.nodeB}},t.NaiveCell=class{constructor(t=1){this.neighborCells=new H(2*t+1,2*t+1,j)}getNeighborCell(t,e){const s=Math.floor(this.neighborCells.xCount/2);return t<-s||t>s||e<-s||e>s?j:this.neighborCells.get2D(t+s,e+s)}setNeighborCell(t,e,s){const i=Math.floor(this.neighborCells.xCount/2);this.neighborCells.set2D(t+i,e+i,s)}},t.NullCell=G,t.Grid=class{constructor(t,e,s,i,n,r){this.nullCell=r,this.cell2DArray=new H(t,e,r),this.cellIndexMap=new Map;for(let a=0;a<e;a+=1)for(let e=0;e<t;e+=1){const t=n(s);this.cell2DArray.set2D(e,a,t),this.cellIndexMap.set(t,{x:e,y:a})}this.cell2DArray.loop(t=>{this.setNeighborCells(t,s,i)})}getCell(t,e){return this.cell2DArray.get2D(t,e)}getCellIndex(t){return this.cellIndexMap.get(t)||{x:-1,y:-1}}getRelativePositionCell(t,e,s,i){if(t===this.nullCell)return t;if(0===e&&0===s)return t;const n=this.getCellIndex(t),r={x:n.x+e,y:n.y+s};if(i)r.x<0?r.x+=this.cell2DArray.xCount:r.x>=this.cell2DArray.xCount&&(r.x-=this.cell2DArray.xCount),r.y<0?r.y+=this.cell2DArray.yCount:r.y>=this.cell2DArray.yCount&&(r.y-=this.cell2DArray.yCount);else if(r.x<0||r.x>=this.cell2DArray.xCount||r.y<0||r.y>=this.cell2DArray.yCount)return this.nullCell;return this.cell2DArray.get2D(r.x,r.y)}setNeighborCells(t,e,s){for(let i=-e;i<=e;i+=1)for(let n=-e;n<=e;n+=1)t.setNeighborCell(i,n,this.getRelativePositionCell(t,i,n,s))}},t.DrawableArray=q,t.SteppableArray=J,t.SpriteArray=K,t.CleanableArray=Z,t.CleanableSpriteArray=$,t.ObjectPool=class{constructor(t,e,s){this.naivePool=t,this.useProcess=e||(t=>{}),this.recycleProcess=s||(t=>{}),this.recycle=(t=>{this.recycleProcess(t),this.naivePool.recycle(t)})}use(){const t=this.naivePool.use();return this.useProcess(t),t}recycleAll(t){t.loop(this.recycle)}},t.PoolableArray=class extends Z{constructor(t,e){super(e),this.pool=t}clean(){super.clean(),this.recentRemovedElements.loop(this.pool.recycle),this.recentRemovedElements.clear()}},t.ShapeColor=c,t.RandomShapeColor=class{constructor(){this.candidateArray=[]}pushCandidateFromFunction(t,e){for(let s=0;s<e;s+=1)this.candidateArray.push(t());return this}pushCandidate(t,e=1){for(let s=0;s<e;s+=1)this.candidateArray.push(t);return this}clear(){return this.candidateArray.length=0,this}get(){return x(this.candidateArray)}},t.setIlluminant=function(t){k=t},t.cielabColor=N,t.cielchColor=function(t,e,s,i){return N(t,e*Math.cos(s),e*Math.sin(s),i)},t.Illuminants=_,t.degamma=V,t.subtractColor=function(t,e,s){return d.color(d.red(t)-d.red(e),d.green(t)-d.green(e),d.blue(t)-d.blue(e),s)},t.hsbColor=function(t,e,s,i){d.colorMode(d.HSB,360,100,100,255);const n=d.color(t,e,s);d.colorMode(d.RGB,1,1,1,255);const r=d.color(V(d.red(n)),V(d.green(n)),V(d.blue(n)),i);return d.colorMode(d.RGB,255,255,255,255),r},t.Drawer=et,t.DrawerBuilder=class{constructor(t){this.drawParam={},this.p=t}setElement(t){return this.element=t,this}setPositionRef(t){return this.drawParam.positionRef=t,this}setOffsetPositionRef(t){return this.drawParam.offsetPositionRef=t,this}setRotationAngleRef(t){return this.drawParam.rotationAngleRef=t,this}setScaleFactorRef(t){return this.drawParam.scaleFactorRef=t,this}setShapeColorRef(t){return this.drawParam.shapeColorRef=t,this}setAlphaChannelRef(t){return this.drawParam.alphaChannelRef=t,this}setStrokeWeightRef(t){return this.drawParam.strokeWeightRef=t,this}setTextSizeRef(t){return this.drawParam.textSizeRef=t,this}build(){return new et(this.p,this.element,this.drawParam)}},t.ShapeType=st,t.ShapeTypes=nt,t.ScalableShape=class{constructor(t,e,s,i=new S(1)){this.p=t,this.shapeType=e,this.baseShapeSize=s,this.scaleFactorRef=i}draw(){this.shapeType.drawShape(this.p,this.scaleFactorRef.value*this.baseShapeSize)}},t.LineSegment=class{constructor(t,e,s,i,n){this.p=t,this.x1=e,this.y1=s,this.x2=i,this.y2=n}draw(){this.p.currentRenderer.line(this.x1,this.y1,this.x2,this.y2)}},t.CircularArc=class{constructor(t,e,s,i,n,r,a,o){this.p=t,this.centerPosition=e,this.diameter=s,this.startAngle=i,this.endAngle=n,this.startRatio=a,this.endRatio=o,this.isClockwise=r}get isClockwise(){return this._isClockwise}set isClockwise(t){this._isClockwise=t,this.validate=t?rt:at,this.drawTrimmedArc=t?ot:ht}draw(){this.validate(this);const t=this.endAngle.value-this.startAngle.value,e=this.startAngle.value+this.startRatio.value*t,s=this.startAngle.value+this.endRatio.value*t;this.drawTrimmedArc(this.p,this.centerPosition,this.diameter.value,e,s)}},t.QuadraticBezierCurve=class{constructor(t,e,s,i,n,r,a){this.pointList=new Array(n+1),this.resolution=n,this.startRatio=r,this.endRatio=a,this.p=t;for(let o=0;o<=n;o+=1){const r=o/n,a=1-r;lt.set(a*e.x+r*s.x,a*e.y+r*s.y),ct.set(a*s.x+r*i.x,a*s.y+r*i.y),this.pointList[o]=t.createVector(a*lt.x+r*ct.x,a*lt.y+r*ct.y)}}static checkControlPoint(t,e,s,i,n,r){const a=i*i;if(p(t,e)<a)return!1;if(p(t,s)<a)return!1;const o=Math.abs(y(m(t,e),m(t,s)));return!(o<n||o>r)}draw(){const t=Math.floor(this.startRatio.value*this.resolution),e=Math.floor(this.endRatio.value*this.resolution),s=this.endRatio.value*this.resolution-e,i=this.p.currentRenderer,n=this.pointList;i.beginShape();for(let r=t;r<=e;r+=1)i.vertex(n[r].x,n[r].y);s>0&&i.vertex(n[e].x+s*(n[e+1].x-n[e].x),n[e].y+s*(n[e+1].y-n[e].y)),i.endShape()}},t.drawSineWave=function(t,e,s,i){const n=t.currentRenderer,r=.5*s;let a=!1;n.beginShape();for(let o=0;o<=e&&(o>e&&(a=!0),n.vertex(a?e:o,-r*Math.sin(t.TWO_PI*o/i)),!a);o+=1);n.endShape()},t.setPixel=function(t,e,s,i,n,r,a,o){const h=t,l=o||h.pixelDensity();for(let c=0;c<l;c+=1)for(let t=0;t<l;t+=1){const o=4*((s*l+t)*h.width*l+(e*l+c));h.pixels[o]=i,h.pixels[o+1]=n,h.pixels[o+2]=r,h.pixels[o+3]=a}},t.lerpPixel=function(t,e,s,i,n,r,a,o=1){const h=t,l=a||h.pixelDensity();for(let c=0;c<l;c+=1)for(let t=0;t<l;t+=1){const a=4*((s*l+t)*h.width*l+(e*l+c));h.pixels[a]=R(h.pixels[a],i,o),h.pixels[a+1]=R(h.pixels[a+1],n,o),h.pixels[a+2]=R(h.pixels[a+2],r,o)}},t.FontUnit=ut,t.FontManager=class{constructor(t){this.p=t,this.fontMap=new Map}register(t,e){return this.fontMap.set(t,new ut(this.p,t,e)),this}loadAll(){for(const t of this.fontMap.values())t.loadFile()}applyFont(t){const e=this.fontMap.get(t);e&&e.applyFont()}},t.ScaleFactor=tt,t.AngleQuantity=dt,t.KinematicQuantity=gt,t.PhysicsBody=class{constructor(){this.kinematicQuantity=new gt,this.position=this.kinematicQuantity.position,this.velocity=this.kinematicQuantity.velocity,this.mass=1,this.collisionRadius=0,this.hasFriction=!1,this.decelerationFactor=1}get x(){return this.position.x}get y(){return this.position.y}get z(){return this.position.z}get vx(){return this.velocity.x}get vy(){return this.velocity.y}get vz(){return this.velocity.z}getSpeed(){return this.kinematicQuantity.getSpeed()}getDirection(){return this.kinematicQuantity.getDirection()}setFriction(t){0!==t?(this.hasFriction=!0,this.decelerationFactor=1-t):this.hasFriction=!1}constrainSpeed(t){this.velocity.magSq()>t*t&&this.velocity.setMag(t)}step(){this.kinematicQuantity.step(),this.hasFriction&&this.kinematicQuantity.velocity.mult(this.decelerationFactor)}accelerate(t,e,s){this.kinematicQuantity.velocity.add(t,e,s)}applyForce(t){this.accelerate(t.x/this.mass,t.y/this.mass,t.z/this.mass)}addSpeed(t){this.kinematicQuantity.addSpeed(t)}collides(t){return p(this.position,t.position)<this.collisionRadius*this.collisionRadius+t.collisionRadius*t.collisionRadius}bounce(t,e=1){this.velocity.add(p5.Vector.mult(t,(1+e)*p5.Vector.dot(this.velocity,p5.Vector.mult(t,-1))))}attractEachOther(t,e,s=0,i,n){const r=this.calculateAttractionForce(t.position,e,s,i,n);r&&(this.applyForce(r),r.mult(-1),t.applyForce(r))}attractToPoint(t,e,s=0,i,n){const r=this.calculateAttractionForce(t,e,s,i,n);r&&this.applyForce(r)}calculateAttractionForce(t,e,s=0,i,n){const r=ft;p5.Vector.sub(t,this.position,r);const a=r.magSq();let o=Math.abs(e)/a;return n&&o<n?null:(o=i?Math.min(Math.max(o,s),i):Math.max(o,s),r.setMag(o),e<0&&r.mult(-1),r)}},t.calculateLeverageForce=function(t,e,s,i,n,r){const a=r||d.createVector(),o=t+(n?-d.HALF_PI:d.HALF_PI);return a.set(Math.cos(o),Math.sin(o)),a.setMag(i*s/e),a},t.FrameCounter=yt,t.LoopedFrameCounter=class extends mt{constructor(t,e){super(t,e)}on(t){return super.on(t),this}off(){return super.off(),this}getProgressRatio(){return this.count/this.durationFrameCount}completeCycle(){this.completeBehavior(),this.count=0}},t.NonLoopedFrameCounter=class extends mt{get isCompleted(){return this._isCompleted}constructor(t,e){super(t,e),this._isCompleted=!1}on(t){return super.on(t),this}off(){return super.off(),this}resetCount(){return super.resetCount(),this._isCompleted=!1,this}getProgressRatio(){return this._isCompleted?1:this.count/this.durationFrameCount}completeCycle(){this._isCompleted=!0,this._isOn=!1,this.completeBehavior()}},t.keyDown=Rt,t.listenKey=function(){window.addEventListener("keydown",t=>{switch(Rt.set(t.key,!0),Rt.set(t.code,!0),t.key){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":return!1;default:return}}),window.addEventListener("keyup",t=>{switch(Rt.set(t.key,!1),Rt.set(t.code,!1),t.key){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":return!1;default:return}})},t.mouseOnCanvas=function(t){return!(t.mouseX<0||t.mouseX>t.width||t.mouseY<0||t.mouseY>t.height)},Object.defineProperty(t,"__esModule",{value:!0})});